set firewall ipv4 name ALLOW_ALL_TO_PROD default-action 'accept'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN default-action 'drop'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN description 'Allow SSH from Kraken to Nexsus'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 action 'accept'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 description 'SSH TCP 22'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 destination address '10.0.1.5'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 destination port '22'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 protocol 'tcp'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 10 source address '10.0.0.0/16'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 action 'accept'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 description 'Allow SSH from Kraken host'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 destination address '10.0.1.5'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 destination port '22'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 protocol 'tcp'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 20 source address '10.0.254.11'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 30 action 'accept'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 30 destination port '22'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 30 protocol 'tcp'
set firewall ipv4 name ALLOW_SSH_FROM_KRAKEN rule 30 source address '10.0.254.11'
set firewall ipv4 name MGMT_TO_PROD default-action 'drop'
set firewall ipv4 name MGMT_TO_PROD rule 10 action 'accept'
set firewall ipv4 name MGMT_TO_PROD rule 10 protocol 'icmp'
set firewall ipv4 name MGMT_TO_PROD rule 20 action 'accept'
set firewall ipv4 name MGMT_TO_PROD rule 20 destination port '22'
set firewall ipv4 name MGMT_TO_PROD rule 20 protocol 'tcp'
set firewall ipv4 name MGMT_TO_PROD rule 30 action 'accept'
set firewall ipv4 name MGMT_TO_PROD rule 30 state 'established'
set firewall ipv4 name MGMT_TO_PROD rule 30 state 'related'
set firewall ipv4 name MGMT_TO_PROD_ICMP default-action 'drop'
set firewall ipv4 name MGMT_TO_PROD_ICMP rule 10 action 'accept'
set firewall ipv4 name MGMT_TO_PROD_ICMP rule 10 description 'Allow ICMP MGMT to PROD'
set firewall ipv4 name MGMT_TO_PROD_ICMP rule 10 protocol 'icmp'
set firewall ipv4 name PROD_TO_MGMT default-action 'drop'
set firewall ipv4 name PROD_TO_MGMT rule 10 action 'accept'
set firewall ipv4 name PROD_TO_MGMT rule 30 action 'accept'
set firewall ipv4 name PROD_TO_MGMT rule 30 state 'established'
set firewall ipv4 name PROD_TO_MGMT_STATE default-action 'drop'
set firewall ipv4 name PROD_TO_MGMT_STATE rule 10 action 'accept'
set firewall ipv4 name PROD_TO_MGMT_STATE rule 10 description 'Allow established/related traffic back to MGMT'
set firewall ipv4 name PROD_TO_MGMT_STATE rule 10 state 'established'
set firewall ipv4 name PROD_TO_MGMT_STATE rule 10 state 'related'
set firewall zone MGMT description 'Management zone'
set firewall zone MGMT from PROD firewall name 'PROD_TO_MGMT'
set firewall zone MGMT member interface 'eth0'
set firewall zone PROD description 'Production zone'
set firewall zone PROD from MGMT firewall name 'MGMT_TO_PROD'
set firewall zone PROD member interface 'eth2'
set interfaces ethernet eth0 address '10.0.1.1/30'
set interfaces ethernet eth0 description 'VYOS-TO-PFSENSE'
set interfaces ethernet eth0 hw-id '08:00:27:42:c2:f5'
set interfaces ethernet eth1 address '10.0.10.11/24'
set interfaces ethernet eth1 description 'ssh here'
set interfaces ethernet eth1 hw-id '08:00:27:5e:d5:99'
set interfaces ethernet eth2 address '10.0.1.6/30'
set interfaces ethernet eth2 description 'Uplink to core-router eth4'
set interfaces ethernet eth2 hw-id '08:00:27:8c:1b:0a'
set interfaces loopback lo
set policy access-list 100 description 'Allow SSH from Kraken to Nexsus'
set policy access-list 100 rule 10 action 'permit'
set policy access-list 100 rule 10 destination host '10.0.1.5'
set policy access-list 100 rule 10 source host '10.0.254.11'
set protocols bgp neighbor 10.0.1.5 description 'core-router'
set protocols bgp neighbor 10.0.1.5 remote-as '65001'
set protocols bgp system-as '65000'
set protocols ospf interface eth2 area '0'
set protocols ospf interface eth2 network 'point-to-point'
set protocols ospf parameters router-id '10.0.1.6'
set protocols static route 0.0.0.0/0 next-hop 10.0.1.2
set protocols static route 10.0.3.0/26 next-hop 10.0.1.5
set protocols static route 10.0.12.0/24 next-hop 10.0.1.5
set service ntp allow-client address '127.0.0.0/8'
set service ntp allow-client address '169.254.0.0/16'
set service ntp allow-client address '10.0.0.0/8'
set service ntp allow-client address '172.16.0.0/12'
set service ntp allow-client address '192.168.0.0/16'
set service ntp allow-client address '::1/128'
set service ntp allow-client address 'fe80::/10'
set service ntp allow-client address 'fc00::/7'
set service ntp server time1.vyos.net
set service ntp server time2.vyos.net
set service ntp server time3.vyos.net
set service ssh listen-address '10.0.254.1'
set service ssh listen-address '10.0.10.11'
set service ssh port '22'
set system config-management commit-revisions '100'
set system console device ttyS0 speed '115200'
set system host-name 'vyos-router'
set system login operator-group default command-policy allow '*'
set system login user vyos authentication encrypted-password '$6$rounds=656000$MyJGo40sovGJdaho$WFKYhCSD1KBoTwM3W4Tn9jUamX7pUhrQ/yIjRJwcrokdGZ6bupdhrQBAohgb7fcrdSFr4ZO4Bzn4PVitP8NBY0'
set system login user vyos authentication plaintext-password ''
set system name-server '10.0.1.2'
set system option reboot-on-upgrade-failure '5'
set system sysctl parameter net.ipv4.ip_forward value '1'
set system syslog local facility all level 'info'
set system syslog local facility local7 level 'debug'
